<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>–û–Ω–±–æ—Ä–¥–∏–Ω–≥: –°–∫–∞—É—Ç | –ö–∞—Ä–µ—Ç–∞ –ú–æ–±–∏–ª–∏—Ç–∏</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <style>
        /* --- –°–¢–ò–õ–ò (–í–ù–ï–®–ù–ò–ô –í–ò–î) --- */
        :root { 
            --bg: #ffffff; 
            --text: #000; 
            --yellow: #FFED00; 
            --black: #000; 
        }
        
        body { 
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif; 
            background: var(--bg); 
            color: var(--text); 
            padding: 15px; 
            text-align: center; 
            margin: 0; 
            overflow-x: hidden; 
            -webkit-font-smoothing: antialiased; 
        }
        
        .screen { 
            display: none; 
            background: #fff; 
            padding: 20px; 
            border-radius: 24px; 
            margin-top: 10px; 
            border: 3px solid var(--yellow); 
            animation: fadeIn 0.4s cubic-bezier(0.165, 0.84, 0.44, 1); 
            box-shadow: 0 10px 25px rgba(0,0,0,0.08); 
        }
        
        .screen.center { 
            text-align: center; 
        }
        
        .active { 
            display: block; 
        }
        
        @keyframes fadeIn { 
            from { opacity: 0; transform: translateY(20px); } 
            to { opacity: 1; transform: translateY(0); } 
        }
        
        h2 { 
            text-transform: uppercase; 
            font-size: 22px; 
            margin-bottom: 10px; 
            letter-spacing: 0.5px; 
            color: var(--black); 
            font-weight: 800; 
            line-height: 1.2; 
        }
        
        p { 
            color: #555; 
            font-size: 15px; 
            line-height: 1.4; 
            margin-bottom: 20px; 
            font-weight: 500; 
        }
        
        input { 
            width: 100%; 
            padding: 16px; 
            margin-top: 10px; 
            border: 3px solid var(--yellow); 
            border-radius: 14px; 
            font-size: 18px; 
            box-sizing: border-box; 
            text-align: center; 
            font-weight: bold; 
            outline: none; 
            transition: 0.3s; 
            background: #fafafa; 
        }
        
        input:focus { 
            border-color: var(--black); 
            background: #fff; 
        }
        
        button { 
            background: var(--yellow); 
            color: #000; 
            border: none; 
            padding: 18px; 
            border-radius: 14px; 
            font-size: 18px; 
            font-weight: 800; 
            width: 100%; 
            margin-top: 20px; 
            text-transform: uppercase; 
            box-shadow: 0 5px 0 #d4c300; 
            cursor: pointer; 
            transition: transform 0.1s, box-shadow 0.1s; 
            display: block; 
        }
        
        button:active { 
            transform: translateY(3px); 
            box-shadow: 0 2px 0 #d4c300; 
        }
        
        button:disabled { 
            background: #e0e0e0; 
            color: #a0a0a0; 
            box-shadow: none; 
            cursor: not-allowed; 
            transform: none; 
        }
        
        .logo-main { 
            width: 120px; 
            height: auto; 
            margin-bottom: 20px; 
            border-radius: 20px; 
            box-shadow: 0 8px 20px rgba(0,0,0,0.1); 
        }
        
        .format-btn { 
            background: #fff; 
            border: 3px solid var(--yellow); 
            color: #000; 
            margin-bottom: 12px; 
            padding: 18px; 
            text-align: left; 
            display: flex; 
            align-items: center; 
            justify-content: space-between; 
            box-shadow: 0 6px 0 #f0f0f0; 
            transition: 0.2s; 
        }
        
        .format-btn:active { 
            transform: translateY(3px); 
            box-shadow: 0 3px 0 #f0f0f0; 
        }
        
        .format-icon { 
            font-size: 28px; 
            margin-right: 15px; 
        }
        
        .format-info div:first-child { 
            font-weight: 800; 
            font-size: 17px; 
            text-transform: uppercase; 
        }
        
        .format-info div:last-child { 
            font-size: 13px; 
            color: #666; 
            margin-top: 4px; 
        }
        
        .pdf-btn { 
            background: #fff; 
            border: 3px solid #e74c3c; 
            color: #e74c3c; 
        }
        
        .media-container { 
            position: relative; 
            border-radius: 16px; 
            overflow: hidden; 
            border: 2px solid var(--yellow); 
            background: #000; 
            margin-bottom: 15px; 
        }
        
        .video-wrapper { 
            position: relative; 
            padding-bottom: 56.25%; 
            height: 0; 
        }
        
        .video-wrapper iframe { 
            position: absolute; 
            top: 0; 
            left: 0; 
            width: 100%; 
            height: 100%; 
        }
        
        .tinder-container { 
            position: relative; 
            height: 500px; 
            width: 100%; 
            margin-top: 10px; 
            perspective: 1000px; 
        }
        
        .tinder-card { 
            position: absolute; 
            top: 0; 
            left: 0; 
            width: 100%; 
            height: 100%; 
            background: #fff; 
            border: 3px solid var(--yellow); 
            border-radius: 20px; 
            overflow: hidden; 
            box-shadow: 0 15px 35px rgba(0,0,0,0.1); 
            transition: transform 0.5s cubic-bezier(0.23, 1, 0.32, 1), opacity 0.5s; 
            display: flex; 
            flex-direction: column; 
            text-align: left; 
        }
        
        .tinder-card.swiped-left { 
            transform: translateX(-200%) rotate(-30deg) !important; 
            opacity: 0; 
        }
        
        .tinder-card.swiped-right { 
            transform: translateX(200%) rotate(30deg) !important; 
            opacity: 0; 
        }
        
        .card-img { 
            width: 100%; 
            height: 45%; 
            object-fit: cover; 
            border-bottom: 3px solid var(--yellow); 
            background: #f0f0f0; 
        }
        
        .card-text { 
            padding: 20px; 
            font-size: 15px; 
            line-height: 1.4; 
            flex-grow: 1; 
            background: #fff; 
            display: flex; 
            flex-direction: column; 
            justify-content: center; 
            font-weight: 500; 
        }
        
        .swipe-hint { 
            font-size: 13px; 
            color: #999; 
            margin-top: 10px; 
            animation: pulse 2s infinite; 
            font-weight: 600; 
        }
        
        @keyframes pulse { 
            0% { opacity: 0.6; } 
            50% { opacity: 1; } 
            100% { opacity: 0.6; } 
        }

        .option { 
            display: flex; 
            align-items: center; 
            padding: 15px; 
            background: #f4f4f4; 
            margin-bottom: 10px; 
            border-radius: 14px; 
            cursor: pointer; 
            text-align: left; 
            border: 2px solid transparent; 
            font-weight: 700; 
            font-size: 15px; 
            transition: 0.2s; 
            -webkit-tap-highlight-color: transparent; 
        }
        
        .option:active { 
            background: #ececec; 
            transform: scale(0.98); 
        }
        
        .status-bar { 
            display: flex; 
            justify-content: space-between; 
            font-weight: 800; 
            background: var(--yellow); 
            padding: 12px 20px; 
            border-radius: 14px; 
            margin-bottom: 15px; 
            box-shadow: 0 4px 0 #d4c300; 
            font-size: 14px; 
        }
    </style>
</head>
<body>

    <div id="statusBar" class="status-bar" style="display: none;">
        <span>–í–û–ü–†–û–°: <span id="q-counter">1/15</span></span>
        <span>üí∞ <span id="coins">0</span></span>
    </div>

    <div id="screen-reg" class="screen center">
        <img src="logo.jpg" class="logo-main" alt="–ö–∞—Ä–µ—Ç–∞ –ú–æ–±–∏–ª–∏—Ç–∏" onerror="this.src='https://via.placeholder.com/150?text=LOGO'">
        <h2>–ü—Ä–∏–≤–µ—Ç, –°–∫–∞—É—Ç! üö¥‚Äç‚ôÇÔ∏è</h2>
        <p>–ó–∞–ø–æ–ª–Ω–∏ –∞–Ω–∫–µ—Ç—É (—Å–æ—Ö—Ä–∞–Ω–∏—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏).</p>
        
        <input type="text" id="user-name" placeholder="–§–ò–û" oninput="validateForm()">
        <input type="tel" id="user-phone" value="+7 " maxlength="18" oninput="validateForm()">
        <input type="text" id="user-city" placeholder="–ì–æ—Ä–æ–¥ (–Ω–∞–ø—Ä–∏–º–µ—Ä, –†–æ—Å—Ç–æ–≤)" oninput="validateForm()">
        <input type="text" id="user-birth" placeholder="–î–∞—Ç–∞ —Ä–æ–∂–¥–µ–Ω–∏—è (–î–î.–ú–ú.–ì–ì–ì–ì)" oninput="validateForm()" maxlength="10">
        
        <button id="btn-start" disabled onclick="saveAndGo()">–î–∞–ª–µ–µ</button>
    </div>

    <div id="screen-formats" class="screen">
        <h2>–§–æ—Ä–º–∞—Ç –æ–±—É—á–µ–Ω–∏—è</h2>
        <p>–í—ã–±–µ—Ä–∏, –∫–∞–∫ —Ç–µ–±–µ —É–¥–æ–±–Ω–µ–µ:</p>
        
        <button class="format-btn" onclick="startCards()">
            <div class="format-info">
                <div>üìñ –ö–∞—Ä—Ç–æ—á–∫–∏</div>
                <div>–°–≤–∞–π–ø–∞–π —Ç–µ–∫—Å—Ç —Å —Ñ–æ—Ç–æ</div>
            </div>
            <div class="format-icon">üëÜ</div>
        </button>
        
        <button class="format-btn" onclick="startVideo()">
            <div class="format-info">
                <div>üì∫ –í–∏–¥–µ–æ</div>
                <div>–°–º–æ—Ç—Ä–µ—Ç—å –æ–±–∑–æ—Ä</div>
            </div>
            <div class="format-icon">‚ñ∂Ô∏è</div>
        </button>
        
        <button class="format-btn" onclick="startAudio()">
            <div class="format-info">
                <div>üéß –ü–æ–¥–∫–∞—Å—Ç</div>
                <div>–°–ª—É—à–∞—Ç—å –≤ —Ñ–æ–Ω–µ</div>
            </div>
            <div class="format-icon">üéµ</div>
        </button>
        
        <button class="format-btn pdf-btn" onclick="openPDF()">
            <div class="format-info">
                <div style="color:#e74c3c">üìë –ü—Ä–µ–∑–µ–Ω—Ç–∞—Ü–∏—è</div>
                <div style="color:#e74c3c">–°–∫–∞—á–∞—Ç—å –∏ —á–∏—Ç–∞—Ç—å</div>
            </div>
            <div class="format-icon">üìÑ</div>
        </button>
    </div>

    <div id="screen-theory-cards" class="screen center">
        <h2>–ü—Ä–∞–≤–∏–ª–∞</h2>
        <div class="swipe-hint">–°–º–∞—Ö–Ω–∏ –≤–ª–µ–≤–æ –∏–ª–∏ –≤–ø—Ä–∞–≤–æ ‚ÜîÔ∏è</div>
        <div class="tinder-container" id="tinder-deck"></div>
        <button id="btn-cards-finish" style="display:none" onclick="startQuiz()">–ö —Ç–µ—Å—Ç—É!</button>
        <button style="background:transparent; color:#999; border:none; box-shadow:none; margin-top:10px; font-size:14px;" onclick="showFormats()">–ù–∞–∑–∞–¥</button>
    </div>

    <div id="screen-theory-video" class="screen center">
        <h2>–í–∏–¥–µ–æ–æ–±–∑–æ—Ä</h2>
        <div class="media-container">
            <div class="video-wrapper">
                <iframe src="https://rutube.ru/play/embed/900cde7cfae7ff125a6a7da1d8d9ce96/?p=x-I4ULg0MU6OYQodDqvM4Q" frameBorder="0" allow="autoplay; fullscreen"></iframe>
            </div>
        </div>
        <button onclick="startQuiz()">–Ø –ø–æ—Å–º–æ—Ç—Ä–µ–ª, –∫ —Ç–µ—Å—Ç—É!</button>
        <button style="background:#fff; color:#000; border:2px solid #eee; margin-top:10px; font-size:14px; box-shadow:none;" onclick="showFormats()">–ù–∞–∑–∞–¥</button>
    </div>

    <div id="screen-theory-audio" class="screen center">
        <h2>–ü–æ–¥–∫–∞—Å—Ç</h2>
        <div style="background:#f4f4f4; padding:30px; border-radius:20px; margin-bottom:20px;">
            <div style="font-size:50px; margin-bottom:10px;">üéß</div>
            <p style="margin-bottom:15px; font-weight:bold;">–°–ª—É—à–∞–π –≤–Ω–∏–º–∞—Ç–µ–ª—å–Ω–æ</p>
            <audio controls style="width: 100%; border-radius: 50px;">
                <source src="podcast.m4a" type="audio/mp4">
            </audio>
        </div>
        <button onclick="startQuiz()">–Ø –ø—Ä–æ—Å–ª—É—à–∞–ª, –∫ —Ç–µ—Å—Ç—É!</button>
        <button style="background:#fff; color:#000; border:2px solid #eee; margin-top:10px; font-size:14px; box-shadow:none;" onclick="showFormats()">–ù–∞–∑–∞–¥</button>
    </div>

    <div id="screen-theory-pdf" class="screen center">
        <h2>–ü—Ä–µ–∑–µ–Ω—Ç–∞—Ü–∏—è</h2>
        <div style="background:#f4f4f4; padding:30px; border-radius:20px; margin-bottom:20px;">
            <div style="font-size:50px; margin-bottom:10px;">üìÑ</div>
            <p style="margin-bottom:15px; font-weight:bold; font-size: 16px;">–û—Ç–∫—Ä–æ–π —Ñ–∞–π–ª, –∏–∑—É—á–∏ –ø—Ä–∞–≤–∏–ª–∞, –∞ –∑–∞—Ç–µ–º –≤–æ–∑–≤—Ä–∞—â–∞–π—Å—è —Å—é–¥–∞ –¥–ª—è —Å–¥–∞—á–∏ —Ç–µ—Å—Ç–∞.</p>
            <button style="background:#e74c3c; color:#fff; box-shadow:0 5px 0 #c0392b; margin-top: 10px;" onclick="window.open('presentation.pdf', '_blank')">üì• –ß–∏—Ç–∞—Ç—å PDF</button>
        </div>
        <button onclick="startQuiz()">–Ø –ø—Ä–æ—á–∏—Ç–∞–ª, –∫ —Ç–µ—Å—Ç—É!</button>
        <button style="background:#fff; color:#000; border:2px solid #eee; margin-top:10px; font-size:14px; box-shadow:none;" onclick="showFormats()">–ù–∞–∑–∞–¥</button>
    </div>

    <div id="screen-quiz" class="screen">
        <h3 id="q-text" style="font-size: 19px; line-height: 1.4; margin-bottom: 20px; font-weight: 800;"></h3>
        <div id="options-box"></div>
    </div>

    <div id="screen-finish" class="screen center">
        <img src="logo.jpg" class="logo-main" alt="–£—Å–ø–µ—Ö" onerror="this.src='https://via.placeholder.com/150?text=WIN'">
        <h2 id="finish-title">–†–µ–∑—É–ª—å—Ç–∞—Ç</h2>
        <p id="res-info" style="font-size:18px; font-weight:bold; color:#000; margin-bottom: 15px;"></p>
        
        <div id="coin-box" style="background:var(--yellow); padding:20px; border-radius: 18px; margin: 20px 0; box-shadow: 0 6px 0 #d4c300;">
            <h3 style="margin:0; font-size: 28px; font-weight: 900;">üí∞ <span id="res-coins">0</span></h3>
        </div>
        
        <p id="send-status" style="font-weight: bold; font-size: 16px;"></p>
        
        <button id="btn-close" disabled onclick="tg.close()" style="display:none; background:#2ecc71; box-shadow: 0 6px 0 #27ae60; color:white;">–ó–∞–∫—Ä—ã—Ç—å –æ–±—É—á–µ–Ω–∏–µ</button>
        <button id="btn-retry" onclick="showFormats()" style="display:none; background:#e74c3c; box-shadow: 0 6px 0 #c0392b; color:white;">–ù–∞ –ø–µ—Ä–µ—Å–¥–∞—á—É</button>
    </div>

    <script>
        const GOOGLE_URL = "https://script.google.com/macros/s/AKfycbxAOyN8XERwNRQRqd80VQOQOXGnujqTpqprFyTMIxa8RM-JzWYA6SYtYTnTKf_AKfAc/exec";
        
        let tg = window.Telegram.WebApp;
        tg.expand();

        let userData = { 
            name: "", 
            phone: "", 
            city: "", 
            birth: "", 
            score: 0, 
            coins: 0 
        };
        
        let currentQ = 0;
        let swipedCards = 0;
        const TOTAL_QUESTIONS = 15;

        // –ü–†–û–í–ï–†–ö–ê –°–û–•–†–ê–ù–ï–ù–ò–Ø
        window.addEventListener('DOMContentLoaded', () => {
            let savedName = localStorage.getItem('scoutName');
            let savedPhone = localStorage.getItem('scoutPhone');
            let savedCity = localStorage.getItem('scoutCity');
            let savedBirth = localStorage.getItem('scoutBirth');

            if (savedName && savedPhone && savedName.length > 1) {
                userData.name = savedName;
                userData.phone = savedPhone;
                userData.city = savedCity || "";
                userData.birth = savedBirth || "";
                
                document.getElementById('user-name').value = savedName;
                document.getElementById('user-phone').value = savedPhone;
                document.getElementById('user-city').value = savedCity || "";
                document.getElementById('user-birth').value = savedBirth || "";
                
                showFormats();
            } else {
                document.getElementById('screen-reg').classList.add('active');
            }
        });

        function validateForm() {
            let n = document.getElementById('user-name').value.trim();
            let c = document.getElementById('user-city').value.trim();
            let b = document.getElementById('user-birth').value.trim();
            let p = document.getElementById('user-phone');
            
            let digits = p.value.replace(/\D/g, '');
            if (digits.startsWith('7') || digits.startsWith('8')) {
                digits = digits.substring(1);
            }
            p.value = digits.length > 0 ? '+7' + digits : '+7'; 
            
            let isValid = (n.length > 2 && c.length > 2 && b.length > 5 && digits.length >= 10);
            document.getElementById('btn-start').disabled = !isValid;
        }

        function saveAndGo() {
            userData.name = document.getElementById('user-name').value;
            userData.phone = document.getElementById('user-phone').value;
            userData.city = document.getElementById('user-city').value;
            userData.birth = document.getElementById('user-birth').value;
            
            localStorage.setItem('scoutName', userData.name);
            localStorage.setItem('scoutPhone', userData.phone);
            localStorage.setItem('scoutCity', userData.city);
            localStorage.setItem('scoutBirth', userData.birth);
            
            showFormats();
        }

        function showFormats() { 
            showScreen('screen-formats'); 
        }
        
        function startVideo() { 
            showScreen('screen-theory-video'); 
        }
        
        function startAudio() { 
            showScreen('screen-theory-audio'); 
        }
        
        function openPDF() { 
            showScreen('screen-theory-pdf'); 
        }
        
        function showScreen(id) {
            document.querySelectorAll('.screen').forEach(s => s.classList.remove('active'));
            document.getElementById(id).classList.add('active');
        }

        // --- –õ–û–ì–ò–ö–ê –ö–ê–†–¢–û–ß–ï–ö ---
        function startCards() {
            showScreen('screen-theory-cards');
            swipedCards = 0;
            document.getElementById('tinder-deck').innerHTML = '';
            document.getElementById('btn-cards-finish').style.display = 'none';
            document.querySelector('.swipe-hint').style.display = 'block';

            const theory = [
                { t: "<b>üëî 1. –°–¢–ê–ù–î–ê–†–¢</b><br>–ó–∞–ø—Ä–µ—â–µ–Ω–æ –∫—É—Ä–∏—Ç—å, –µ—Å—Ç—å –∏–ª–∏ –ø–∏—Ç—å –Ω–∞ –ö–∞—Ä–µ—Ç–µ.", img: "1.jpg" }, 
                { t: "<b>üÖøÔ∏è 2. –ü–ê–†–ö–û–í–ö–ê</b><br>–°—Ç—Ä–æ–≥–æ –≤ –ª–∏–Ω–∏—é, <b>50 —Å–º</b>. –§–∞—Ä—ã —Ä–æ–≤–Ω–æ.", img: "2.png" }, 
                { t: "<b>‚öñÔ∏è 3. –ë–ê–õ–ê–ù–°</b><br>–ú–Ω–æ–≥–æ –∫–∞—Ä–µ—Ç? –£–≤–µ–∑–∏. –ú–∞–ª–æ? –ü—Ä–∏–≥–æ–Ω–∏.", img: "3.jpg" }, 
                { t: "<b>ü§ù 4. –≠–ö–°–ü–ï–†–¢</b><br>–¢—ã ‚Äî —Å–ø–∞—Å–∞—Ç–µ–ª—å–Ω—ã–π –∫—Ä—É–≥. –ó–Ω–∞–π —Ç–∞—Ä–∏—Ñ—ã.", img: "4.png" }, 
                { t: "<b>üì± 5. –ó–ê–†–ü–õ–ê–¢–ê</b><br>–ß–µ—Ä–µ–∑ –±–æ—Ç. –°—Ç–∞—Ä—Ç + <b>—Å–µ–ª—Ñ–∏ –≤ —Ñ–æ—Ä–º–µ</b>.", img: "5.png" }, 
                { t: "<b>üõ† 6. –ò–ù–í–ï–ù–¢–ê–†–¨</b><br>–ö–ª—é—á–∏ 13/15, –æ—Ç–≤–µ—Ä—Ç–∫–∞, —Å—Ç—è–∂–∫–∏, –º–∏–∫—Ä–æ—Ñ–∏–±—Ä–∞.", img: "6.png" }, 
                { t: "<b>üîß 7. –†–ï–ú–û–ù–¢</b><br>–ú–µ–ª–∫–æ–µ ‚Äî —Å–∞–º. –°–ª–æ–∂–Ω–æ–µ ‚Äî <b>–ø–∏—à–∏ –≤ –±–æ—Ç</b>.", img: "7.png" }, 
                { t: "<b>üéß 8. –ê–£–î–ò–û–ì–ò–î</b><br>–¶–µ–Ω–∞ ‚Äî <b>1 —Ä—É–±–ª—å</b>. –ü—Ä–µ–¥–ª–∞–≥–∞–π –∫–∞–∂–¥–æ–º—É.", img: "8.png" }
            ];

            // –ò–°–ü–†–ê–í–õ–ï–ù–ò–ï: –ü–µ—Ä–µ–≤–æ—Ä–∞—á–∏–≤–∞–µ–º –º–∞—Å—Å–∏–≤ –ø–µ—Ä–µ–¥ –æ—Ç—Ä–∏—Å–æ–≤–∫–æ–π, —á—Ç–æ–±—ã –ö–∞—Ä—Ç–æ—á–∫–∞ 1 –±—ã–ª–∞ —Å–≤–µ—Ä—Ö—É
            let reversedTheory = [...theory].reverse();
            
            reversedTheory.forEach((item, i) => {
                let card = document.createElement('div');
                card.className = 'tinder-card';
                
                // –ò–°–ü–†–ê–í–õ–ï–ù–ò–ï: –£–º–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –∫–∞—Ä—Ç–∏–Ω–æ–∫.
                let fallbackImg = item.img.includes('.jpg') ? item.img.replace('.jpg', '.png') : item.img.replace('.png', '.jpg');
                let fallbackImgJpeg = item.img.includes('.jpg') ? item.img.replace('.jpg', '.jpeg') : item.img.replace('.png', '.jpeg');
                
                card.innerHTML = `
                    <img src="${item.img}" class="card-img" onerror="this.onerror=null; this.src='${fallbackImg}'; this.onerror=function(){this.onerror=null; this.src='${fallbackImgJpeg}';};">
                    <div class="card-text">${item.t}</div>
                `;
                
                document.getElementById('tinder-deck').appendChild(card);
                setupSwipe(card);
            });
        }

        let questions = [
            { 
                q: "–ö–∞–∫ —Å—á–∏—Ç–∞–µ—Ç—Å—è –≤—Ä–µ–º—è?", 
                a: ["–ë–ª–æ–∫–Ω–æ—Ç", "–ë–æ—Ç (–≥–µ–æ–ª–æ–∫–∞—Ü–∏—è)", "–°–ª–æ–≤–∞–º–∏"], 
                c: 1, 
                p: true 
            },
            { 
                q: "–°—Ç–∞—Ä—Ç —Å–º–µ–Ω—ã –≤ –±–æ—Ç–µ?", 
                a: ["–ö–Ω–æ–ø–∫–∞", "–ö–Ω–æ–ø–∫–∞ + —Å–µ–ª—Ñ–∏ –≤ —Ñ–æ—Ä–º–µ", "–ß–∞—Ç"], 
                c: 1, 
                p: true 
            },
            { 
                q: "–ì–¥–µ –∫–ª—é—á–∏?", 
                a: ["–î–æ–º–∞", "–ü–∏–ª–æ–Ω/–°–∫–ª–∞–¥", "–ö—É–ø–∏—Ç—å"], 
                c: 1, 
                p: true 
            },
            { 
                q: "–ó–∞—á–µ–º —â–µ—Ç–∫–∞?", 
                a: ["–í–æ–ª–æ—Å—ã", "–ì—Ä—è–∑—å —Å —Ä–∞–º—ã", "–û–¥–µ–∂–¥–∞"], 
                c: 1, 
                p: true 
            },
            { 
                q: "–ü–µ—Ä–µ–±–æ—Ä –∫–∞—Ä–µ—Ç?", 
                a: ["–ñ–¥–∞—Ç—å", "–£–≥–Ω–∞—Ç—å –ª–∏—à–Ω–∏–µ", "–£–π—Ç–∏"], 
                c: 1, 
                p: true 
            },
            { 
                q: "–ö–ª—é—á–∏ –¥–ª—è —Ä–µ–º–æ–Ω—Ç–∞?", 
                a: ["10/12", "13/15", "–†–∞–∑–≤–æ–¥–Ω–æ–π"], 
                c: 1, 
                p: true 
            },
            { 
                q: "–ì—Ä—É–∑–æ–ø–æ–¥—ä–µ–º–Ω–æ—Å—Ç—å?", 
                a: ["–ù–µ –∑–Ω–∞—é", "–ù–∞–∑–æ–≤—É —Ü–∏—Ñ—Ä—É", "–°–µ–∫—Ä–µ—Ç"], 
                c: 1, 
                p: true 
            },
            { 
                q: "–î–∏—Å—Ç–∞–Ω—Ü–∏—è?", 
                a: ["0 —Å–º", "50 —Å–º", "1 –º–µ—Ç—Ä"], 
                c: 1, 
                p: true 
            },
            { 
                q: "–ö—É—Ä–∏—Ç—å –≤ –∫–∞—Ä–µ—Ç–µ?", 
                a: ["–ú–æ–∂–Ω–æ", "–ó–∞–ø—Ä–µ—â–µ–Ω–æ", "–ò–Ω–æ–≥–¥–∞"], 
                c: 1, 
                p: true 
            },
            { 
                q: "–¢—Ä–µ—â–∏–Ω–∞ –≤ —Ä–∞–º–µ?", 
                a: ["–°–∫–æ—Ç—á", "–ë–æ—Ç + –¢–ú", "–ú–æ–ª—á–∞—Ç—å"], 
                c: 1, 
                p: true 
            },
            { 
                q: "–¶–µ–Ω–∞ –∞—É–¥–∏–æ–≥–∏–¥–∞?", 
                a: ["0", "1 —Ä—É–±–ª—å", "500"], 
                c: 1, 
                p: false 
            },
            { 
                q: "–ß–∏—Å—Ç–æ—Ç–∞ ‚Äî —ç—Ç–æ...", 
                a: ["–°–∏–¥–µ–Ω—å–µ", "–ü—ã–ª—å", "–í—Å—ë –¥–æ –±–ª–µ—Å–∫–∞"], 
                c: 2, 
                p: true 
            },
            { 
                q: "–§–æ—Ä–º–∞?", 
                a: ["–ù–µ—Ç", "–û–±—è–∑–∞—Ç–µ–ª—å–Ω–æ", "–ü—Ä–∞–∑–¥–Ω–∏–∫–∏"], 
                c: 1, 
                p: false 
            },
            { 
                q: "–ü–µ—Ä–µ–≥–æ–Ω –∫–∞—Ä–µ—Ç—ã?", 
                a: ["–ì—Ä—è–∑–Ω–æ–π", "–ß–∏—Å—Ç–æ–π", "–ë—ã—Å—Ç—Ä–æ"], 
                c: 0, 
                p: true 
            },
            { 
                q: "–ö–ª–∏–µ–Ω—Ç –≥—Ä—É–±–∏—Ç?", 
                a: ["–ì—Ä—É–±–∏—Ç—å", "–í–µ–∂–ª–∏–≤–æ –ø–æ–º–æ—á—å", "–ò–≥–Ω–æ—Ä"], 
                c: 1, 
                p: true 
            }
        ];

        function setupSwipe(card) {
            let startX = 0; 
            let isDragging = false;
            
            card.ontouchstart = e => { 
                startX = e.touches[0].clientX; 
                isDragging = true; 
                card.style.transition = 'none'; 
            };
            
            card.ontouchmove = e => { 
                if (!isDragging) return; 
                let diff = e.touches[0].clientX - startX; 
                card.style.transform = `translateX(${diff}px) rotate(${diff/20}deg)`; 
            };
            
            card.ontouchend = e => {
                isDragging = false; 
                card.style.transition = 'transform 0.5s';
                let diff = e.changedTouches[0].clientX - startX;
                
                if (Math.abs(diff) > 100) {
                    tg.HapticFeedback.impactOccurred('medium');
                    card.classList.add(diff > 0 ? 'swiped-right' : 'swiped-left');
                    swipedCards++;
                    
                    setTimeout(() => { 
                        card.remove(); 
                        if (swipedCards >= 8) { 
                            document.getElementById('btn-cards-finish').style.display = 'block'; 
                            document.querySelector('.swipe-hint').style.display = 'none'; 
                        } 
                    }, 300);
                } else {
                    card.style.transform = 'translate(0)';
                }
            };
        }

        function startQuiz() {
            userData.score = 0; 
            userData.coins = 0; 
            currentQ = 0;
            
            questions.sort(() => Math.random() - 0.5);
            
            showScreen('screen-quiz');
            document.getElementById('statusBar').style.display = 'flex';
            renderQ();
        }

        function renderQ() {
            let q = questions[currentQ];
            document.getElementById('q-counter').innerText = `${currentQ+1}/${TOTAL_QUESTIONS}`;
            document.getElementById('q-text').innerText = q.q;
            document.getElementById('options-box').innerHTML = q.a.map((opt, i) => `
                <div class="option" onclick="handleAns(${i})">${opt}</div>
            `).join('');
        }

        function handleAns(idx) {
            if (idx === questions[currentQ].c) { 
                userData.score++; 
                if (questions[currentQ].p) {
                    userData.coins += 100; 
                }
                tg.HapticFeedback.notificationOccurred('success'); 
            } else {
                tg.HapticFeedback.notificationOccurred('error');
            }
            
            currentQ++;
            if (currentQ < TOTAL_QUESTIONS) {
                renderQ(); 
            } else {
                showFinish();
            }
        }

        function showFinish() {
            showScreen('screen-finish');
            document.getElementById('statusBar').style.display = 'none';
            document.getElementById('res-info').innerText = userData.name;
            document.getElementById('res-coins').innerText = userData.coins;
            
            if (userData.score < 12) {
                document.getElementById('finish-title').innerText = "–¢–µ—Å—Ç –Ω–µ —Å–¥–∞–Ω ‚ùå";
                document.getElementById('send-status').innerText = `–ù—É–∂–Ω–æ 12 –∏–∑ 15 (—É —Ç–µ–±—è ${userData.score})`;
                document.getElementById('send-status').style.color = "#e74c3c";
                document.getElementById('coin-box').style.display = "none";
                document.getElementById('btn-close').style.display = "none";
                document.getElementById('btn-retry').style.display = "block";
            } else {
                document.getElementById('finish-title').innerText = "–°–¥–∞–Ω–æ! ‚úÖ";
                document.getElementById('send-status').innerText = "–û—Ç–ø—Ä–∞–≤–∫–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤...";
                document.getElementById('send-status').style.color = "#2ecc71";
                document.getElementById('coin-box').style.display = "block";
                document.getElementById('btn-close').style.display = "block";
                document.getElementById('btn-retry').style.display = "none";
                
                const payload = JSON.stringify({
                    name: userData.name, 
                    phone: userData.phone,
                    city: userData.city,
                    birth: userData.birth,
                    role: "–°–∫–∞—É—Ç",
                    score: userData.score, 
                    coins: userData.coins,
                    tg_user: tg.initDataUnsafe.user ? tg.initDataUnsafe.user.username : "—Å–∫—Ä—ã—Ç"
                });

                fetch(GOOGLE_URL, {
                    method: "POST",
                    mode: "no-cors",
                    headers: { "Content-Type": "text/plain" },
                    body: payload
                }).then(() => {
                    document.getElementById('send-status').innerText = "‚úÖ –î–ê–ù–ù–´–ï –í –¢–ê–ë–õ–ò–¶–ï!";
                    document.getElementById('btn-close').disabled = false;
                }).catch(err => {
                    document.getElementById('send-status').innerText = "–û—à–∏–±–∫–∞ —Å–µ—Ç–∏, —Å–∫—Ä–∏–Ω—à–æ—Ç—å —ç–∫—Ä–∞–Ω!";
                    console.error(err);
                });
            }
        }
    </script>
</body>
</html>
